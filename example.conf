[name="pipeline" type="dpp::chain_module"]
  #logging.priority : string = "debug"
  modules : string[1] = "Cimrman"

[name="Cimrman" type="Cimrman"]

  verbosity : string = "fatal"
  CD_label  : string = "CD"   # Input bank identifier
  TCD_label : string = "TCD"  # Output bank identifier (tracker clusters)
  TTD_label : string = "TTD"  # Output bank identifier (tracker trajectories)

  # #@description Configuration parameters for internal reconstruction algorithms 
  
  ############################
  # Cimrman general settings #
  ############################
  
  eventrec.verbosity : string = "fatal"
  
  # Save png images of the event (debug purposes)
  eventrec.visualization_2D : boolean = false
  
  # Save root files with the event geometry (debug purposes)
  eventrec.visualization_3D : boolean = false
  
  # Enable/disable polyline tracking ("polyline" / "line")
  eventrec.electron_mode : string = "polyline"
  
  # Enable/disable alpha tracking 
  eventrec.reconstruct_alphas : boolean = true
  
  # Use provided TCD bank (if available) as preclustering
  eventrec.use_provided_preclustering : boolean = true
  
  # delete suboptimal solutions from the final solution collections
  eventrec.keep_only_best_solutions : boolean = true
  
  # Use a default drift radius uncertainty instead of provided Falaise values
  eventrec.force_default_sigma_r : boolean = false
  
  # Default drift radius uncertainty
  eventrec.default_sigma_r : real as length = 2.0 mm
  
  # Maximum allowed threshold to keep trajectories (currently not impelmented)
  eventrec.chi_square_threshold : real = 5.0
  

  #######################
  # Electron clustering #
  #######################
  
  # Threshold distance for spatial clustering
  clustering.max_distance : real as length = 130.0 mm
  
  # Maximum distance to associate tracker hit to a track
  clustering.hit_association_distance : real as length = 6.0 mm
  
  # Setting for sinograms in Legendre transform clustering of prompt hits
  clustering.sinograms.save_sinograms : boolean = false
  clustering.sinograms.iterations : integer = 2
  clustering.sinograms.zoom_factor : real = 10.0
  clustering.sinograms.resolution_phi : integer = 100
  clustering.sinograms.resolution_r : integer = 200  
  clustering.sinograms.uncertainty : real as length = 3.0 mm
  
  # Choosing fewer bins in r if the predefined initial precisioncan be achieved with fewer bins (currently not impelmented)
  clustering.sinograms.max_initial_precision_r : real as length = 6.0 mm 
  
  
  ####################
  # Alpha clustering #
  ####################
  
  # Angle sampling used to estimate angular bounds for alpha track
  alphas.clustering_resolution_phi : integer = 100
  
  # Minimum value of used drift times
  alphas.min_possible_drift_time : real as time = 0.0 ns
  
  # Maximum value of used drift times
  alphas.max_possible_drift_time : real as time = 6000.0 ns
  
  # Size of time step for fitting the missing reference time
  alphas.time_step : real as time = 50.0 ns
  
  # Setting for sinograms in Legendre transform clustering of delayed hits
  alphas.sinograms.save_sinograms : boolean = false
  alphas.sinograms.iterations : integer = 2
  alphas.sinograms.zoom_factor : real = 10.0
  alphas.sinograms.phi_step : real as angle = 2.0 deg 
  alphas.sinograms.resolution_r : integer = 30
  alphas.sinograms.delta_r : real as length = 60.0 mm
  alphas.sinograms.uncertainty : real as length = 1.5 mm
  
  
  ########################################
  # Primary kink detection - sharp kinks #
  ########################################
  
  # Maximum vertical distance of two tracks to be connected 
  polylines.max_vertical_distance : real as length = 40.0 mm
  
  # Maximum allowed distance between the potential kink point and associated tracker hits of the two tracks
  polylines.max_tracker_hits_distance : real as length = 100.0 mm  
  
  # Maximum allowed kink angle (in 3D)
  polylines.max_kink_angle : real as angle = 120.0 deg
  
  # Minimum allowed distance of the kink from the foil
  polylines.min_distance_from_foil : real as length = 75.0 mm
  
  # Minimum allowed distance of the kink from mainwalls
  polylines.min_distance_from_main_walls : real as length = 50.0 mm
  
  # Minimum allowed distance of the kink from X walls
  polylines.min_distance_from_X_walls : real as length = 50.0 mm
  
  
  #########################
  # Trajectory refinement #
  #########################
  
  # Maximum allowed length to prolong the track to include previously unassociated or incorrectly associated hit
  polylines.max_extention_distance : real as length = 120.0 mm


  ##########################################
  # Secondary kink detection - small kinks #
  ##########################################

  # Maximum allowed horizontal distance between the original tracks (the underlaying line without endpoints) and the potential kink point
  polylines.max_trajectories_middlepoint_distance : real as length = 15.0 mm
  
  # Maximum allowed distance between the endpoints of two trajectories to be connected 
  polylines.max_trajectory_endpoints_distance : real as length = 100.0 mm 
  
  # Maximum allowed kink angle (in 3D)
  polylines.max_trajectory_connection_angle : real as angle = 40.0 deg

  
# end
